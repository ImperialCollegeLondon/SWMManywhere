[build-system]
build-backend = "setuptools.build_meta"
requires = [
  "setuptools",
  "setuptools-scm",
]

[tool.setuptools.packages.find]
exclude = ["htmlcov"] # Exclude the coverage report file from setuptools package finder

[project]
name = "swmmanywhere"
version = "0.0.1"
authors = [
    { name = "Barnaby Dobson", email = "b.dobson@imperial.ac.uk" },
    { name = "Imperial College London RSE Team", email = "ict-rse-team@imperial.ac.uk" }
]
requires-python = ">=3.10"
classifiers = [
  "Programming Language :: Python :: 3 :: Only",
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: 3.11",
  "Programming Language :: Python :: 3.12",
]
dependencies = [
  "cdsapi",
  "cytoolz",
  "fastparquet",
  "fiona",
  "geopandas",
  "geopy",
  "GitPython",
  "joblib",
  "jsonschema",
  "loguru",
  "netcdf4",
  "netcomp@ git+https://github.com/barneydobson/NetComp.git",
  "networkx>=3",
  "numpy<2.0.0",
  "osmnx",
  "pandas",
  "planetary_computer",
  "pyarrow",
  "pydantic",
  "pyflwdir",
  "pysheds==0.3.5",
  "pystac_client",
  "pyswmm",
  "PyYAML",
  "rasterio",
  "rioxarray",
  "SciPy",
  "shapely",
  "tqdm",
  "xarray",
]
[project.optional-dependencies]
dev = [
  "mypy",
  "pip-tools",
  "pre-commit",
  "pytest",
  "pytest-cov",
  "pytest-mock",
  "pytest-mypy",
  "ruff",
]
doc = [
  "mkdocs",
  "mkdocs-coverage",
  "mkdocs-include-markdown-plugin",
  "mkdocs-jupyter",
  "mkdocs-material",
  "mkdocs-material-extensions",
  "mkdocstrings[python]",
]

[tool.mypy]
disallow_any_explicit = false
disallow_any_generics = false
warn_unreachable = true
warn_unused_ignores = false
disallow_untyped_defs = false
exclude = [".venv/"]

[[tool.mypy.overrides]]
module = "tests.*"
disallow_untyped_defs = false

[tool.pytest.ini_options]
addopts = "-v -p no:warnings --cov=swmmanywhere --cov-report=html --doctest-modules --ignore=swmmanywhere/logging.py"

[tool.ruff]
select = ["D", "E", "F", "I"] # pydocstyle, pycodestyle, Pyflakes, isort

[tool.ruff.per-file-ignores]
"tests/*" = ["D100", "D104"]

[tool.ruff.pydocstyle]
convention = "google"

[tool.ruff.lint.isort]
required-imports = ["from __future__ import annotations"]

[tool.codespell]
skip = "swmmanywhere/defs/iso_converter.yml,*.inp"
ignore-words-list = "gage,gages"

[tool.refurb]
ignore = [
        184, # Because some frankly bizarre suggestions
        109  # Because pyyaml doesn't support tuples
        ]
